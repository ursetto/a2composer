MIDI-MAGIC analysis and repair
==============================

Files in this directory
-----------------------

- `midi-magic.all.s` -- rebuild MIDI-MAGIC binary from disassembled source (use `inv build`)
- `midi-magic.s` -- disassembled source code of MIDI-MAGIC, analyzed by me (use `:src midi.magic` in TFBD and `inv pull`)
- `midi-magic.fix.s` -- my educated guess patch as to what was in the bad sectors -- basically, read the DOS33 catalog, and place ^ files in the file table and @ file in the disk name
- `midi-magic.t` -- raw TFBD template file (`inv pull`)
- `midi-magic.t.txt` -- TFBD template file decoded with tfbd.py (use `inv pull`)
- `midi-magic.e.s` -- midi-magic equates generated by TFBD `:src`
- `midi-magic.x.s` -- midi-magic externals generated by TFBD `:src`
- `mcat.s` -- traverse DOS catalog via RWTS; standalone demo binary
- `tasks.py` -- invoke tasks to build, decode, sync with git, and move files in and out of disk images
- `tfbd.py` -- decode The Flaming Bird Diassembler `.t` files to textual instructions


Operation
---------

- `init.sh` to install invoke in a venv
- `source venv/bin/activate` so you can run invoke
- `inv --list` to list available tasks -- see above

Disassembling
-------------

- Start a IIGS system disk (I use gsplus and `System 6_0_4.hdv`, removing lots of shareware)
- Install TFBD from 800k disk, say at `/GSHARDDRIVE/TFBD`
- Upload the source code to analyze, say at `/GSHARDDRIVE/TFBD/asm`

In TFBD:

```
pfx
  # Use arrows to navigate to :GSHARDDRIVE:TFBD:asm
load midi.magic
tload midi.magic.t
  # Do your analysis and changes
tsave
src midi.magic
```

`inv pull` any time you `tsave` or `src` to integrate your new changes.
